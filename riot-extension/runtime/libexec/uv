#!/bin/sh
set -e

SCRIPT_DIR="$(CDPATH= cd -- "$(dirname -- "$0")" && pwd)"
PYTHON_BIN="$SCRIPT_DIR/../python/bin/python"

if [ ! -x "$PYTHON_BIN" ]; then
  for candidate in "$SCRIPT_DIR/../python"/*/bin/python; do
    if [ -x "$candidate" ]; then
      PYTHON_BIN="$candidate"
      break
    fi
  done
fi

if [ ! -x "$PYTHON_BIN" ]; then
  exit 1
fi

UV_BIN="$(dirname "$PYTHON_BIN")/uv"

if [ ! -x "$UV_BIN" ]; then
  exit 1
fi

if head -c 2 "$UV_BIN" | grep -q "^#!"; then
  exec "$PYTHON_BIN" "$UV_BIN" "$@"
fi

exec "$UV_BIN" "$@"
